# ADR-001: Миграция с in-memory на реляционную базу данных
Дата: 2025-10-20
Статус: Accepted

## Context
Текущее in-memory хранилище `_DB` ограничивает возможности сервиса: данные теряются при перезапуске, нет транзакций, сложные запросы невозможны. Риск R4 имеет высокую критичность 15 баллов.

## Альтернативные решения

### Вариант 1: PostgreSQL
**Плюсы:**
- Полноценная production-готовая СУБД
- Расширенные возможности: JSONB, полнотекстовый поиск, репликация
- Высокая производительность при больших нагрузках
- Богатая экосистема инструментов мониторинга и бэкапов

**Минусы:**
- Требует отдельного сервера/контейнера
- Сложнее в настройке и администрировании
- Больший overhead для разработки и тестирования
- Дополнительные операционные расходы

### Вариант 2: SQLite (ВЫБРАНО)
**Плюсы:**
- Нулевые зависимости - работает из коробки
- Идеальна для разработки и тестирования
- Простота развертывания - один файл
- Низкие операционные расходы
- Быстрый запуск прототипа

**Минусы:**
- Ограниченная производительность при высоких concurrent нагрузках
- Ограниченные возможности масштабирования
- Нет встроенной репликации

## Decision
Выбрана **SQLite** для быстрого старта. Используем SQLAlchemy ORM для абстракции.

## Consequences
**Плюсы:** Сохранение данных между перезапусками, транзакционная целостность, возможность сложных запросов, быстрый старт
**Минусы:** Ограничения масштабирования, необходимость будущей миграции при росте нагрузки.
**Влияние:** Увеличивает надежность.

## Links
- NFR-04 (Целостность данных)
- R4, F6 из Thread Model
---

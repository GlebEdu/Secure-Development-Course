# ADR-003: Rate Limiting стратегия с многоуровневыми лимитами
Дата: 2025-10-20
Статус: Accepted

## Context
Существующий rate limit 50/минуту слишком общий. Нужна гранулярная защита от R7 (Перегрузка API) и атак на эндпоинты аутентификации.

## Decision
Многоуровневая стратегия лимитов на основе `slowapi`:

**Глобальные лимиты:**
- По умолчанию: 100 запросов/минуту на IP
- Эндпоинты создания: 10 запросов/минуту на IP (`/habits`, `/checkins`)

**Специфичные лимиты:**
- `/health`: 500/минуту (мониторинг)
- Эндпоинты аутентификации (будущие): 5/минуту на IP
- Админские эндпоинты: по API-ключу


## Consequences
**Плюсы:** Защита от DoS, справедливое распределение ресурсов, прозрачность для клиентов
**Минусы:** Сложность конфигурации, зависимость от Redis
**Влияние:** Увеличивает отказоустойчивость сервиса при пиковых нагрузках.

## Links
- NFR-01, NFR-05 (Производительность и лимиты)
- R7, FastAPI из Thread Model
